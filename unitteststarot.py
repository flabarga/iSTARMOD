import matplotlib.pyplot as plt
from starot  import*
from fshift import*
import numpy as np
#from scipy import signal 
# from rotBroad import *

workingLambdaValues = [6540.032284012789, 6540.1138282357915, 6540.195372458793, 6540.276916681795, 6540.358460904797, 6540.440005127799, 6540.5215493508, 6540.603093573803, 6540.684637796804, 6540.766182019806, 6540.847726242808, 6540.92927046581, 6541.0108146888115, 6541.092358911814, 6541.173903134815, 6541.2554473578175, 6541.336991580819, 6541.418535803821, 6541.500080026823, 6541.581624249825, 6541.663168472826, 6541.744712695829, 6541.82625691883, 6541.907801141832, 6541.989345364834, 6542.070889587836, 6542.1524338108375, 6542.23397803384, 6542.315522256841, 6542.3970664798435, 6542.478610702845, 6542.560154925847, 6542.641699148849, 6542.723243371851, 6542.804787594852, 6542.886331817855, 6542.967876040856, 6543.049420263858, 6543.13096448686, 6543.212508709862, 6543.294052932863, 6543.375597155866, 6543.457141378867, 6543.5386856018695, 6543.620229824871, 6543.701774047873, 6543.783318270875, 6543.864862493877, 6543.946406716878, 6544.027950939881, 6544.109495162882, 6544.191039385883, 6544.272583608886, 6544.354127831887, 6544.435672054889, 6544.517216277891, 6544.598760500893, 6544.680304723895, 6544.761848946897, 6544.843393169898, 6544.924937392901, 6545.006481615902, 6545.088025838904, 6545.169570061906, 6545.251114284908, 6545.332658507909, 6545.414202730912, 6545.495746953913, 6545.577291176915, 6545.658835399917, 6545.740379622919, 6545.8219238459205, 6545.903468068923, 6545.985012291924, 6546.066556514927, 6546.148100737928, 6546.22964496093, 6546.311189183932, 6546.392733406934, 6546.474277629935, 6546.555821852938, 6546.637366075939, 6546.718910298941, 6546.800454521943, 6546.881998744945, 6546.9635429679465, 6547.045087190949, 6547.12663141395, 6547.208175636953, 6547.289719859954, 6547.371264082956, 6547.452808305958, 6547.53435252896, 6547.615896751961, 6547.697440974964, 6547.778985197965, 6547.860529420967, 6547.942073643969, 6548.023617866971, 6548.1051620899725, 6548.186706312975, 6548.268250535976, 6548.3497947589785, 6548.43133898198, 6548.512883204982, 6548.594427427984, 6548.675971650986, 6548.757515873987, 6548.83906009699, 6548.920604319991, 6549.002148542993, 6549.083692765995, 6549.165236988997, 6549.2467812119985, 6549.328325435001, 6549.409869658002, 6549.4914138810045, 6549.572958104006, 6549.654502327008, 6549.73604655001, 6549.817590773012, 6549.899134996013, 6549.980679219016, 6550.062223442017, 6550.143767665019, 6550.225311888021, 6550.306856111023, 6550.3884003340245, 6550.469944557027, 6550.551488780028, 6550.6330330030305, 6550.714577226032, 6550.796121449034, 6550.877665672036, 6550.959209895038, 6551.040754118039, 6551.122298341042, 6551.203842564043, 6551.285386787045, 6551.366931010047, 6551.448475233049, 6551.5300194560505, 6551.611563679053, 6551.693107902054, 6551.7746521250565, 6551.856196348058, 6551.93774057106, 6552.019284794062, 6552.100829017064, 6552.182373240065, 6552.263917463068, 6552.345461686069, 6552.427005909071, 6552.508550132073, 6552.590094355075, 6552.671638578076, 6552.753182801079, 6552.83472702408, 6552.9162712470825, 6552.997815470084, 6553.079359693086, 6553.160903916088, 6553.24244813909, 6553.323992362091, 6553.405536585094, 6553.487080808095, 6553.568625031097, 6553.650169254099, 6553.731713477101, 6553.813257700102, 6553.894801923105, 6553.976346146106, 6554.0578903691085, 6554.13943459211, 6554.220978815112, 6554.302523038114, 6554.384067261116, 6554.465611484117, 6554.54715570712, 6554.628699930121, 6554.710244153123, 6554.791788376125, 6554.873332599127, 6554.954876822128, 6555.036421045131, 6555.117965268132, 6555.199509491134, 6555.281053714136, 6555.362597937138, 6555.44414216014, 6555.525686383142, 6555.607230606143, 6555.688774829146, 6555.770319052147, 6555.851863275149, 6555.933407498151, 6556.014951721153, 6556.096495944154, 6556.178040167157, 6556.259584390158, 6556.34112861316, 6556.422672836162, 6556.504217059164, 6556.585761282166, 6556.667305505168, 6556.748849728169, 6556.830393951172, 6556.911938174173, 6556.993482397175, 6557.075026620177, 6557.156570843179, 6557.23811506618, 6557.319659289183, 6557.401203512184, 6557.482747735186, 6557.564291958188, 6557.64583618119, 6557.7273804041915, 6557.808924627194, 6557.890468850195, 6557.972013073198, 6558.053557296199, 6558.135101519201, 6558.216645742203, 6558.298189965205, 6558.379734188206, 6558.461278411209, 6558.54282263421, 6558.624366857212, 6558.705911080214, 6558.787455303216, 6558.8689995262175, 6558.95054374922, 6559.032087972221, 6559.1136321952235, 6559.195176418225, 6559.276720641227, 6559.358264864229, 6559.439809087231, 6559.521353310232, 6559.602897533235, 6559.684441756236, 6559.765985979238, 6559.84753020224, 6559.929074425242, 6560.0106186482435, 6560.092162871246, 6560.173707094247, 6560.2552513172495, 6560.336795540251, 6560.418339763253, 6560.499883986255, 6560.581428209257, 6560.662972432258, 6560.744516655261, 6560.826060878262, 6560.907605101264, 6560.989149324266, 6561.070693547268, 6561.1522377702695, 6561.233781993272, 6561.315326216273, 6561.3968704392755, 6561.478414662277, 6561.559958885278, 6561.641503108281, 6561.723047331282, 6561.804591554284, 6561.886135777286, 6561.967680000288, 6562.0492242232895, 6562.130768446292, 6562.212312669293, 6562.2938568922955, 6562.375401115297, 6562.456945338299, 6562.538489561301, 6562.620033784303, 6562.701578007304, 6562.783122230307, 6562.864666453308, 6562.94621067631, 6563.027754899312, 6563.109299122314, 6563.190843345315, 6563.272387568318, 6563.353931791319, 6563.4354760143215, 6563.517020237323, 6563.598564460325, 6563.680108683327, 6563.761652906329, 6563.84319712933, 6563.924741352333, 6564.006285575334, 6564.087829798336, 6564.169374021338, 6564.25091824434, 6564.332462467341, 6564.414006690344, 6564.495550913345, 6564.577095136347, 6564.658639359349, 6564.740183582351, 6564.821727805353, 6564.903272028355, 6564.984816251356, 6565.066360474359, 6565.14790469736, 6565.229448920362, 6565.310993143364, 6565.392537366366, 6565.474081589367, 6565.55562581237, 6565.637170035371, 6565.718714258373, 6565.800258481375, 6565.881802704377, 6565.963346927379, 6566.044891150381, 6566.126435373382, 6566.207979596385, 6566.289523819386, 6566.371068042388, 6566.45261226539, 6566.534156488392, 6566.615700711393, 6566.697244934396, 6566.778789157397, 6566.860333380399, 6566.941877603401, 6567.023421826403, 6567.1049660494045, 6567.186510272407, 6567.268054495408, 6567.349598718411, 6567.431142941412, 6567.512687164414, 6567.594231387416, 6567.675775610418, 6567.757319833419, 6567.838864056422, 6567.920408279423, 6568.001952502425, 6568.083496725427, 6568.165040948429, 6568.2465851714305, 6568.328129394433, 6568.409673617434, 6568.491217840437, 6568.572762063438, 6568.65430628644, 6568.735850509442, 6568.817394732444, 6568.898938955445, 6568.980483178448, 6569.062027401449, 6569.143571624451, 6569.225115847453, 6569.306660070455, 6569.3882042934565, 6569.469748516459, 6569.55129273946, 6569.6328369624625, 6569.714381185464, 6569.795925408466, 6569.877469631468, 6569.95901385447, 6570.040558077471, 6570.122102300474, 6570.203646523475, 6570.285190746477, 6570.366734969479, 6570.448279192481, 6570.5298234154825, 6570.611367638485, 6570.692911861486, 6570.7744560844885, 6570.85600030749, 6570.937544530492, 6571.019088753494, 6571.100632976496, 6571.182177199497, 6571.2637214225, 6571.345265645501, 6571.426809868503, 6571.508354091505, 6571.589898314507, 6571.6714425375085, 6571.752986760511, 6571.834530983512, 6571.9160752065145, 6571.997619429516, 6572.079163652518, 6572.16070787552, 6572.242252098522, 6572.323796321523, 6572.405340544526, 6572.486884767527, 6572.568428990529, 6572.649973213531, 6572.731517436533, 6572.8130616595345, 6572.894605882537, 6572.976150105538, 6573.0576943285405, 6573.139238551542, 6573.220782774544, 6573.302326997546, 6573.383871220548, 6573.465415443549, 6573.546959666552, 6573.628503889553, 6573.710048112555, 6573.791592335557, 6573.873136558559, 6573.9546807815605, 6574.036225004563, 6574.117769227564, 6574.1993134505665, 6574.280857673568, 6574.36240189657, 6574.443946119572, 6574.525490342574, 6574.607034565575, 6574.688578788578, 6574.770123011579, 6574.851667234581, 6574.933211457583, 6575.014755680585, 6575.096299903586, 6575.177844126589, 6575.25938834959, 6575.3409325725925, 6575.422476795594, 6575.504021018596, 6575.585565241598, 6575.6671094646, 6575.748653687601, 6575.830197910604, 6575.911742133605, 6575.993286356607, 6576.074830579609, 6576.156374802611, 6576.237919025612, 6576.319463248615, 6576.401007471616, 6576.482551694618, 6576.56409591762, 6576.645640140622, 6576.727184363624, 6576.808728586626, 6576.890272809627, 6576.97181703263, 6577.053361255631, 6577.134905478633, 6577.216449701635, 6577.297993924637, 6577.379538147638, 6577.461082370641, 6577.542626593642, 6577.624170816644, 6577.705715039646, 6577.787259262648, 6577.86880348565, 6577.950347708652, 6578.031891931653, 6578.113436154656, 6578.194980377657, 6578.276524600659, 6578.358068823661, 6578.439613046663, 6578.521157269664, 6578.602701492666, 6578.684245715668, 6578.76578993867, 6578.847334161672, 6578.928878384673, 6579.0104226076755, 6579.091966830677, 6579.173511053679, 6579.255055276681, 6579.336599499683, 6579.418143722684, 6579.499687945687, 6579.581232168688, 6579.66277639169, 6579.744320614692, 6579.825864837694, 6579.9074090606955, 6579.988953283698, 6580.070497506699, 6580.1520417297015, 6580.233585952703, 6580.315130175705, 6580.396674398707, 6580.478218621709, 6580.55976284471, 6580.641307067713, 6580.722851290714, 6580.804395513716, 6580.885939736718, 6580.96748395972, 6581.0490281827215, 6581.130572405724, 6581.212116628725, 6581.2936608517275, 6581.375205074729, 6581.456749297731, 6581.538293520733, 6581.619837743735, 6581.701381966736, 6581.782926189739, 6581.86447041274, 6581.946014635742, 6582.027558858744, 6582.109103081746, 6582.1906473047475, 6582.27219152775, 6582.353735750751, 6582.4352799737535, 6582.516824196755, 6582.598368419757, 6582.679912642759, 6582.761456865761, 6582.843001088762, 6582.924545311765, 6583.006089534766, 6583.087633757768, 6583.16917798077, 6583.250722203772, 6583.3322664267735, 6583.413810649776, 6583.495354872777, 6583.5768990957795, 6583.658443318781, 6583.739987541783, 6583.821531764785, 6583.903075987787, 6583.984620210788, 6584.066164433791, 6584.147708656792, 6584.229252879794, 6584.310797102796, 6584.392341325798, 6584.473885548799, 6584.555429771802, 6584.636973994803, 6584.7185182178055, 6584.800062440807, 6584.881606663809, 6584.963150886811, 6585.044695109813, 6585.126239332814, 6585.207783555817, 6585.289327778818, 6585.37087200182, 6585.452416224822, 6585.533960447824, 6585.615504670825, 6585.697048893828, 6585.778593116829, 6585.860137339831, 6585.941681562833, 6586.023225785835, 6586.104770008837, 6586.186314231839, 6586.26785845484, 6586.349402677843, 6586.430946900844, 6586.512491123846, 6586.594035346848, 6586.67557956985, 6586.757123792851, 6586.838668015854, 6586.920212238855, 6587.001756461857, 6587.083300684859, 6587.164844907861, 6587.246389130863, 6587.327933353865, 6587.409477576866, 6587.491021799869, 6587.57256602287, 6587.654110245872, 6587.735654468874, 6587.817198691876, 6587.898742914877, 6587.98028713788, 6588.061831360881, 6588.143375583883, 6588.224919806885, 6588.306464029887, 6588.3880082528885, 6588.469552475891, 6588.551096698892, 6588.632640921895, 6588.714185144896, 6588.795729367898, 6588.8772735909, 6588.958817813902, 6589.040362036903, 6589.121906259906, 6589.203450482907, 6589.284994705909, 6589.366538928911, 6589.448083151913, 6589.5296273749145, 6589.611171597917, 6589.692715820918, 6589.774260043921, 6589.855804266922, 6589.937348489924, 6590.018892712926, 6590.100436935928, 6590.181981158929, 6590.263525381932, 6590.345069604933, 6590.426613827935, 6590.508158050937, 6590.589702273939, 6590.6712464969405, 6590.752790719943, 6590.834334942944, 6590.9158791659465, 6590.997423388948, 6591.07896761195, 6591.160511834952, 6591.242056057954, 6591.323600280955, 6591.405144503958, 6591.486688726959, 6591.568232949961, 6591.649777172963, 6591.731321395965, 6591.8128656189665, 6591.894409841969, 6591.97595406497, 6592.0574982879725, 6592.139042510974, 6592.220586733976, 6592.302130956978, 6592.38367517998, 6592.465219402981, 6592.546763625984, 6592.628307848985, 6592.709852071987, 6592.791396294989, 6592.872940517991, 6592.9544847409925, 6593.036028963995, 6593.117573186996, 6593.1991174099985, 6593.280661633, 6593.362205856002, 6593.443750079004, 6593.525294302006, 6593.606838525007, 6593.68838274801, 6593.769926971011, 6593.851471194013, 6593.933015417015, 6594.014559640017, 6594.0961038630185, 6594.177648086021, 6594.259192309022, 6594.3407365320245, 6594.422280755026, 6594.503824978028, 6594.58536920103, 6594.666913424032, 6594.748457647033, 6594.830001870036, 6594.911546093037, 6594.993090316039, 6595.074634539041, 6595.156178762043, 6595.2377229850445, 6595.319267208047, 6595.400811431048, 6595.4823556540505, 6595.563899877052, 6595.645444100053, 6595.726988323056, 6595.808532546058, 6595.890076769059, 6595.971620992061, 6596.053165215063, 6596.134709438065, 6596.216253661067, 6596.297797884068, 6596.37934210707, 6596.460886330072, 6596.542430553074, 6596.623974776076, 6596.705518999078, 6596.787063222079, 6596.868607445082, 6596.950151668083, 6597.031695891085, 6597.113240114087, 6597.194784337089, 6597.27632856009, 6597.357872783093, 6597.439417006094, 6597.520961229096, 6597.602505452098, 6597.6840496751, 6597.7655938981015, 6597.847138121104, 6597.928682344105, 6598.010226567108, 6598.091770790109, 6598.173315013111, 6598.254859236113, 6598.336403459115, 6598.417947682116, 6598.499491905119, 6598.58103612812, 6598.662580351122, 6598.744124574124, 6598.825668797126, 6598.9072130201275, 6598.98875724313]
yin = [1.0044529438018799, 1.0018086433410645, 1.0027077198028564, 1.0029324293136597, 0.9941079020500183, 0.9926961064338684, 0.9965392351150513, 0.993968665599823, 0.996626079082489, 0.9961687326431274, 0.984869658946991, 0.9853828549385071, 0.9954367280006409, 1.001832365989685, 1.0044790506362915, 0.9985884428024292, 0.9959750771522522, 0.9984513521194458, 1.0062577724456787, 1.009398341178894, 1.003470778465271, 0.9910721778869629, 0.9894528985023499, 0.9904130101203918, 0.9910119771957397, 0.983906626701355, 0.9773340225219727, 0.9437617659568787, 0.916947603225708, 0.9494532346725464, 0.9737330079078674, 0.9741154313087463, 0.9712582230567932, 0.9857676029205322, 0.994782567024231, 0.9843518733978271, 0.9711555242538452, 0.9611247181892395, 0.9609420895576477, 0.9733908772468567, 0.9798113703727722, 0.9859107136726379, 1.0025217533111572, 1.0017036199569702, 0.9900771379470825, 0.9793434739112854, 0.9263566732406616, 0.8167670369148254, 0.798057496547699, 0.9135456681251526, 0.9821233153343201, 0.9828920960426331, 0.9869077205657959, 0.9720598459243774, 0.9772056937217712, 0.9919621348381042, 0.9852002859115601, 0.9893753528594971, 0.9950255751609802, 0.9895719885826111, 0.986594021320343, 0.9882652759552002, 0.9919114708900452, 0.9842922687530518, 0.9877616763114929, 0.9951173663139343, 0.9904176592826843, 0.9771441221237183, 0.9614514708518982, 0.9047078490257263, 0.7208746671676636, 0.47825178503990173, 0.48338252305984497, 0.7374975681304932, 0.9054639935493469, 0.957241952419281, 0.9734468460083008, 0.9884034395217896, 0.9958425164222717, 0.9850049614906311, 0.9889751076698303, 1.0022035837173462, 0.9970049262046814, 0.992638349533081, 0.9906002283096313, 0.9867836236953735, 0.9899510145187378, 0.9830419421195984, 0.9856246709823608, 0.9892972111701965, 0.9824492931365967, 0.9757111072540283, 0.9783424139022827, 0.9412920475006104, 0.8965799808502197, 0.9232288002967834, 0.9641067385673523, 0.9678993821144104, 0.9836518168449402, 1.001643180847168, 1.009312629699707, 1.0046567916870117, 0.9988999366760254, 0.9933653473854065, 0.9343698024749756, 0.8438307046890259, 0.8550840616226196, 0.9446782469749451, 0.9950283169746399, 1.0038983821868896, 0.9959043264389038, 0.9964057207107544, 0.9894002676010132, 0.99713134765625, 1.0092486143112183, 1.0140948295593262, 1.0148522853851318, 1.0069751739501953, 1.0011098384857178, 0.9991626739501953, 0.990482747554779, 0.9868622422218323, 0.9935346245765686, 0.9955853819847107, 0.9949884414672852, 0.9949586391448975, 1.0024548768997192, 1.002903938293457, 0.9972671270370483, 0.9964259266853333, 1.007376790046692, 1.016811728477478, 1.0117573738098145, 1.0078396797180176, 0.9928916692733765, 0.9833794832229614, 0.9770752787590027, 0.9543356895446777, 0.9229680895805359, 0.9573661088943481, 0.9982483983039856, 1.000538945198059, 0.9945862889289856, 0.9936782121658325, 0.9977114796638489, 1.0039386749267578, 0.9930470585823059, 0.9736876487731934, 0.9768092632293701, 0.986929714679718, 0.9880853295326233, 0.9887226819992065, 0.9863982796669006, 0.9418279528617859, 0.8401160836219788, 0.8195669054985046, 0.9203280806541443, 0.9664884805679321, 0.9828647971153259, 1.0002529621124268, 1.0039036273956299, 0.9998294711112976, 1.005174994468689, 1.0076675415039062, 1.0003845691680908, 0.9946607351303101, 0.9981141090393066, 0.9789883494377136, 0.8663175106048584, 0.6766460537910461, 0.7401998043060303, 0.9286127686500549, 0.9940748810768127, 0.9937083721160889, 0.9889686107635498, 0.9810945987701416, 0.9654450416564941, 0.9528109431266785, 0.9743368625640869, 0.9844695329666138, 0.9749065637588501, 0.9725565314292908, 0.9662330150604248, 0.9217102527618408, 0.8590449690818787, 0.8789095878601074, 0.9396892786026001, 0.974082350730896, 0.9696462154388428, 0.9631694555282593, 0.9473784565925598, 0.7961210608482361, 0.6850051879882812, 0.823227047920227, 0.9696148633956909, 0.9905369281768799, 0.9926876425743103, 1.0014530420303345, 0.9996038675308228, 0.9828104972839355, 0.9370816946029663, 0.9065099954605103, 0.9458924531936646, 0.9902253746986389, 0.99308842420578, 0.9874460697174072, 0.9876834154129028, 0.9887200593948364, 0.9861335158348083, 0.9518347978591919, 0.8957594037055969, 0.9076875448226929, 0.9657759666442871, 0.9809775948524475, 0.9768763780593872, 0.9752026200294495, 0.9611891508102417, 0.9562300443649292, 0.9635502099990845, 0.9718522429466248, 0.9704570174217224, 0.9472364187240601, 0.9329932928085327, 0.9529803991317749, 0.9731079339981079, 0.9866228699684143, 0.9722919464111328, 0.9645084738731384, 0.9650645852088928, 0.9676203727722168, 0.9712152481079102, 0.9800809025764465, 0.971030592918396, 0.9461634755134583, 0.9137604832649231, 0.8885034918785095, 0.9285866022109985, 0.9542095065116882, 0.9563965797424316, 0.9683604836463928, 0.9707298874855042, 0.9679570198059082, 0.9543455839157104, 0.9446698427200317, 0.9494118094444275, 0.9457918405532837, 0.9084529280662537, 0.8782286643981934, 0.899350643157959, 0.9182429909706116, 0.9108826518058777, 0.8920799493789673, 0.9062361717224121, 0.9227715134620667, 0.9202852845191956, 0.9170984029769897, 0.9079746603965759, 0.9006496071815491, 0.8841670751571655, 0.8730648159980774, 0.8797760009765625, 0.879978358745575, 0.8729199767112732, 0.8632707595825195, 0.8472877144813538, 0.8204310536384583, 0.7796118259429932, 0.7037785649299622, 0.6006735563278198, 0.47956642508506775, 0.3674113154411316, 0.2906504273414612, 0.24475176632404327, 0.21850566565990448, 0.20367980003356934, 0.20240485668182373, 0.21325859427452087, 0.23959723114967346, 0.284677654504776, 0.3606809973716736, 0.4674353003501892, 0.5562193393707275, 0.6389272212982178, 0.7427515387535095, 0.8140857815742493, 0.8426780700683594, 0.8598964810371399, 0.8522467613220215, 0.8421714901924133, 0.8539685606956482, 0.8772027492523193, 0.8998239636421204, 0.9073407649993896, 0.9045922160148621, 0.8965725898742676, 0.8696987628936768, 0.8281118869781494, 0.8452182412147522, 0.9115826487541199, 0.9384804964065552, 0.947258472442627, 0.961547315120697, 0.9619706869125366, 0.9565796852111816, 0.9533475041389465, 0.9572670459747314, 0.9448310136795044, 0.9116548299789429, 0.9113317728042603, 0.9492184519767761, 0.9775646328926086, 0.9762332439422607, 0.9647400379180908, 0.9614595174789429, 0.9742123484611511, 0.9780237078666687, 0.9717063903808594, 0.9819183945655823, 0.9866434335708618, 0.9849352836608887, 0.979595959186554, 0.978759765625, 0.9722258448600769, 0.975616991519928, 0.9835595488548279, 0.9797523617744446, 0.9808520078659058, 0.991864800453186, 0.9912581443786621, 0.985670804977417, 0.9888935089111328, 0.99378901720047, 0.9981174468994141, 0.993330180644989, 0.992511510848999, 0.9944184422492981, 1.000044584274292, 1.0017060041427612, 1.0051958560943604, 1.0048195123672485, 0.9877723455429077, 0.9981621503829956, 1.0040196180343628, 0.9926708936691284, 0.9945114850997925, 0.997383177280426, 0.9925097823143005, 0.9908336997032166, 0.9911311268806458, 0.9798170924186707, 0.9652153253555298, 0.9205644130706787, 0.7669870257377625, 0.5999383926391602, 0.680784285068512, 0.8818573951721191, 0.9622437953948975, 0.9791319370269775, 0.9789847731590271, 0.9799993634223938, 0.9813719987869263, 0.9745046496391296, 0.9740679860115051, 0.9817249774932861, 0.9942259788513184, 0.9973159432411194, 0.9950113892555237, 0.9930394887924194, 0.9870155453681946, 0.9951810240745544, 1.0039290189743042, 0.993482768535614, 0.98197340965271, 0.9837135076522827, 0.9863971471786499, 0.969758152961731, 0.9543136358261108, 0.9614388942718506, 0.9769801497459412, 0.9948585033416748, 1.000147819519043, 0.9987376928329468, 1.002994179725647, 1.0039541721343994, 1.0026787519454956, 1.001217246055603, 1.0012770891189575, 1.0062795877456665, 1.0058125257492065, 0.9929420351982117, 0.9888095855712891, 0.9830800294876099, 0.937609851360321, 0.8809226155281067, 0.9026933908462524, 0.9194258451461792, 0.7390916347503662, 0.5848644375801086, 0.725700318813324, 0.9215967059135437, 0.9968541264533997, 1.010123372077942, 1.0114315748214722, 1.0075448751449585, 1.0097309350967407, 1.0047922134399414, 1.0039864778518677, 1.0068074464797974, 1.003919243812561, 1.0001927614212036, 0.9964123964309692, 0.9965001344680786, 0.999755322933197, 0.9474176168441772, 0.7763375043869019, 0.7346488237380981, 0.8947324752807617, 0.9939713478088379, 1.0062534809112549, 1.0052913427352905, 0.9996984004974365, 0.9942729473114014, 0.9806586503982544, 0.8609815835952759, 0.6414839029312134, 0.6531829237937927, 0.7646950483322144, 0.7710044980049133, 0.8489572405815125, 0.9506644010543823, 0.9935805201530457, 1.0067567825317383, 1.008969783782959, 1.0059994459152222, 0.9996660947799683, 0.9932059049606323, 0.9964351654052734, 1.0019422769546509, 0.9964473843574524, 0.9857768416404724, 0.9832279086112976, 0.9911230206489563, 0.9849376678466797, 0.9896368980407715, 0.9887381792068481, 0.9903467893600464, 0.9971280097961426, 0.9910218715667725, 0.9914840459823608, 0.9928000569343567, 0.9994180202484131, 1.0064061880111694, 1.0084847211837769, 1.0113524198532104, 0.9984202980995178, 0.9969068765640259, 0.9995102286338806, 1.0035240650177002, 0.9999858736991882, 1.0003201961517334, 1.0017645359039307, 1.0036450624465942, 1.0054830312728882, 1.0079705715179443, 1.0001112222671509, 0.9974258542060852, 1.0000399351119995, 0.9972583055496216, 0.9985119700431824, 1.0023952722549438, 1.004414439201355, 1.0027376413345337, 1.0025924444198608, 0.993145227432251, 0.9918097853660583, 0.9993085861206055, 1.0007153749465942, 1.000065565109253, 0.9935339093208313, 0.9830158948898315, 0.9843484163284302, 0.9985418319702148, 1.0002305507659912, 0.9931469559669495, 0.995244562625885, 0.9974891543388367, 0.9939900040626526, 0.9731389284133911, 0.9543589949607849, 0.9641766548156738, 0.972909688949585, 0.9892798662185669, 1.0030349493026733, 1.001649260520935, 1.000209927558899, 0.988764762878418, 0.9799548387527466, 0.9620513319969177, 0.9624292254447937, 0.8890756964683533, 0.7662181854248047, 0.8282124996185303, 0.9530089497566223, 0.98683100938797, 0.9926595687866211, 0.9951906800270081, 0.9883792996406555, 0.9926645755767822, 0.993170440196991, 0.9917827248573303, 0.9990350008010864, 0.9890850782394409, 0.9761767387390137, 0.9844033718109131, 0.9922304749488831, 0.9961584210395813, 0.9976820349693298, 0.9912241101264954, 0.9873777031898499, 0.9742152690887451, 0.97740638256073, 0.9803619980812073, 0.9887789487838745, 0.9858464598655701, 0.9799850583076477, 0.9965820908546448, 0.9961483478546143, 0.998546302318573, 0.9968445897102356, 0.9819457530975342, 0.9464539289474487, 0.9323782920837402, 0.9653517007827759, 0.9739295244216919, 0.9697585701942444, 0.9855917692184448, 0.9967105984687805, 0.9937686324119568, 0.9927230477333069, 1.00142502784729, 0.9978989362716675, 0.986812174320221, 0.9766268134117126, 0.9962456822395325, 1.0060921907424927, 1.001078486442566, 1.0119779109954834, 1.0088868141174316, 1.001983642578125, 1.0017626285552979, 0.9896393418312073, 0.9894726276397705, 0.9982166886329651, 0.9851164221763611, 0.9801803231239319, 0.9858785271644592, 0.9903193712234497, 0.9937134981155396, 1.0003243684768677, 0.9945729374885559, 0.9871561527252197, 0.9422542452812195, 0.803443193435669, 0.7325936555862427, 0.868351936340332, 0.9862313270568848, 0.9983290433883667, 0.9899601936340332, 0.986572802066803, 0.9680225253105164, 0.9371605515480042, 0.9399926066398621, 0.9542471766471863, 0.9703346490859985, 0.9892449975013733, 0.9905638098716736, 0.9846934080123901, 0.9910706281661987, 0.9958021640777588, 0.9973151087760925, 0.9981762170791626, 0.9966088533401489, 0.9964040517807007, 0.9909137487411499, 0.9980799555778503, 1.0126959085464478, 1.0068103075027466, 0.9906860589981079, 1.001478672027588, 1.0076992511749268, 1.0044375658035278, 0.9947824478149414, 0.9944953322410583, 1.0065975189208984, 1.000347375869751, 0.9881068468093872, 0.9868221282958984, 0.9912903308868408, 0.9896568059921265, 0.9840574860572815, 0.9964778423309326, 1.003404974937439, 0.9995768666267395, 1.0065628290176392, 1.0046449899673462, 1.0016740560531616, 1.0046905279159546, 1.002503752708435, 0.9933090806007385, 0.9896793961524963, 0.9989745616912842, 1.0098817348480225, 1.0128169059753418, 1.0094242095947266, 1.0089768171310425, 1.0106111764907837, 1.0060077905654907, 1.0043830871582031, 1.0072414875030518, 1.0072722434997559, 1.0087881088256836, 0.9983236193656921, 1.0057837963104248, 0.9760681390762329, 0.9346873164176941, 0.9598857164382935, 0.9862216114997864, 0.9946123957633972, 0.9921031594276428, 0.9928062558174133, 0.9969831705093384, 0.9843791723251343, 0.9840438961982727, 0.9968364238739014, 0.9928908944129944, 0.9979047179222107, 0.996752917766571, 0.9751277565956116, 0.9217966794967651, 0.8894097805023193, 0.9135133624076843, 0.9161224961280823, 0.8009268641471863, 0.5642402768135071, 0.438812792301178, 0.6301073431968689, 0.8462772369384766, 0.9412389397621155, 0.9652367234230042, 0.9665553569793701, 0.9696363806724548, 0.9842082262039185, 0.9845958948135376, 0.9671540260314941, 0.8350106477737427, 0.5974705815315247, 0.5584349036216736, 0.7834161520004272, 0.949769139289856, 0.994796633720398, 0.9950252175331116, 0.9991788268089294, 0.9900889992713928, 0.9851616024971008, 0.9874790906906128, 0.9898120760917664, 0.979437530040741, 0.9773367047309875, 0.9867661595344543, 0.9900909066200256, 0.99974125623703, 0.9964919090270996, 0.9926045536994934, 0.9800752997398376, 0.9837167263031006, 0.997795820236206, 0.9951147437095642, 0.9999256134033203, 0.997813880443573, 0.9800569415092468, 0.9641876220703125, 0.9753462076187134, 0.9911001324653625, 0.9984989166259766, 1.00029456615448, 1.003025770187378, 1.0083225965499878, 1.0083674192428589, 1.0034894943237305, 0.9924436807632446, 0.9978262186050415, 1.0021183490753174, 1.0138201713562012, 0.9919216632843018, 0.9918051958084106, 0.9950537085533142, 0.996045708656311, 1.0051466226577759, 0.987882137298584, 0.9444836974143982, 0.8267523050308228, 0.7796018123626709, 0.8909658789634705, 0.9814814329147339, 1.0055208206176758, 1.0076980590820312, 1.012492299079895, 1.0034432411193848, 1.0056368112564087, 1.0055274963378906, 0.995137631893158, 1.002474308013916, 0.9654361605644226, 0.9046275019645691, 0.8993321061134338, 0.9571477174758911, 1.0017237663269043, 1.0097088813781738, 0.9742966890335083, 0.8539344668388367, 0.7775871157646179, 0.898716390132904, 0.9885428547859192, 0.9972537159919739]
print ("/////////////////////////////////////////")
midLambda =  6569.55129274
deltaStep = 0.0815442230023
#for i in range(1,len(workingLambdaValues)):
#    print workingLambdaValues[i]-workingLambdaValues[i-1] 
nptsPrimSt = len(yin)
yout =[1.0044529438018799, 1.0018086433410645, 1.0027077198028564, 1.0029324293136597, 0.9941079020500183, 0.9926961064338684, 0.9965392351150513, 0.993968665599823, 0.996626079082489, 0.9961687326431274, 0.984869658946991, 0.9853828549385071, 0.9954367280006409, 1.001832365989685, 1.0044790506362915, 0.9985884428024292, 0.9959750771522522, 0.9984513521194458, 1.0062577724456787, 1.009398341178894, 1.003470778465271, 0.9910721778869629, 0.9894528985023499, 0.9904130101203918, 0.9910119771957397, 0.983906626701355, 0.9773340225219727, 0.9437617659568787, 0.916947603225708, 0.9494532346725464, 0.9737330079078674, 0.9741154313087463, 0.9712582230567932, 0.9857676029205322, 0.994782567024231, 0.9843518733978271, 0.9711555242538452, 0.9611247181892395, 0.9609420895576477, 0.9733908772468567, 0.9798113703727722, 0.9859107136726379, 1.0025217533111572, 1.0017036199569702, 0.9900771379470825, 0.9793434739112854, 0.9263566732406616, 0.8167670369148254, 0.798057496547699, 0.9135456681251526, 0.9821233153343201, 0.9828920960426331, 0.9869077205657959, 0.9720598459243774, 0.9772056937217712, 0.9919621348381042, 0.9852002859115601, 0.9893753528594971, 0.9950255751609802, 0.9895719885826111, 0.986594021320343, 0.9882652759552002, 0.9919114708900452, 0.9842922687530518, 0.9877616763114929, 0.9951173663139343, 0.9904176592826843, 0.9771441221237183, 0.9614514708518982, 0.9047078490257263, 0.7208746671676636, 0.47825178503990173, 0.48338252305984497, 0.7374975681304932, 0.9054639935493469, 0.957241952419281, 0.9734468460083008, 0.9884034395217896, 0.9958425164222717, 0.9850049614906311, 0.9889751076698303, 1.0022035837173462, 0.9970049262046814, 0.992638349533081, 0.9906002283096313, 0.9867836236953735, 0.9899510145187378, 0.9830419421195984, 0.9856246709823608, 0.9892972111701965, 0.9824492931365967, 0.9757111072540283, 0.9783424139022827, 0.9412920475006104, 0.8965799808502197, 0.9232288002967834, 0.9641067385673523, 0.9678993821144104, 0.9836518168449402, 1.001643180847168, 1.009312629699707, 1.0046567916870117, 0.9988999366760254, 0.9933653473854065, 0.9343698024749756, 0.8438307046890259, 0.8550840616226196, 0.9446782469749451, 0.9950283169746399, 1.0038983821868896, 0.9959043264389038, 0.9964057207107544, 0.9894002676010132, 0.99713134765625, 1.0092486143112183, 1.0140948295593262, 1.0148522853851318, 1.0069751739501953, 1.0011098384857178, 0.9991626739501953, 0.990482747554779, 0.9868622422218323, 0.9935346245765686, 0.9955853819847107, 0.9949884414672852, 0.9949586391448975, 1.0024548768997192, 1.002903938293457, 0.9972671270370483, 0.9964259266853333, 1.007376790046692, 1.016811728477478, 1.0117573738098145, 1.0078396797180176, 0.9928916692733765, 0.9833794832229614, 0.9770752787590027, 0.9543356895446777, 0.9229680895805359, 0.9573661088943481, 0.9982483983039856, 1.000538945198059, 0.9945862889289856, 0.9936782121658325, 0.9977114796638489, 1.0039386749267578, 0.9930470585823059, 0.9736876487731934, 0.9768092632293701, 0.986929714679718, 0.9880853295326233, 0.9887226819992065, 0.9863982796669006, 0.9418279528617859, 0.8401160836219788, 0.8195669054985046, 0.9203280806541443, 0.9664884805679321, 0.9828647971153259, 1.0002529621124268, 1.0039036273956299, 0.9998294711112976, 1.005174994468689, 1.0076675415039062, 1.0003845691680908, 0.9946607351303101, 0.9981141090393066, 0.9789883494377136, 0.8663175106048584, 0.6766460537910461, 0.7401998043060303, 0.9286127686500549, 0.9940748810768127, 0.9937083721160889, 0.9889686107635498, 0.9810945987701416, 0.9654450416564941, 0.9528109431266785, 0.9743368625640869, 0.9844695329666138, 0.9749065637588501, 0.9725565314292908, 0.9662330150604248, 0.9217102527618408, 0.8590449690818787, 0.8789095878601074, 0.9396892786026001, 0.974082350730896, 0.9696462154388428, 0.9631694555282593, 0.9473784565925598, 0.7961210608482361, 0.6850051879882812, 0.823227047920227, 0.9696148633956909, 0.9905369281768799, 0.9926876425743103, 1.0014530420303345, 0.9996038675308228, 0.9828104972839355, 0.9370816946029663, 0.9065099954605103, 0.9458924531936646, 0.9902253746986389, 0.99308842420578, 0.9874460697174072, 0.9876834154129028, 0.9887200593948364, 0.9861335158348083, 0.9518347978591919, 0.8957594037055969, 0.9076875448226929, 0.9657759666442871, 0.9809775948524475, 0.9768763780593872, 0.9752026200294495, 0.9611891508102417, 0.9562300443649292, 0.9635502099990845, 0.9718522429466248, 0.9704570174217224, 0.9472364187240601, 0.9329932928085327, 0.9529803991317749, 0.9731079339981079, 0.9866228699684143, 0.9722919464111328, 0.9645084738731384, 0.9650645852088928, 0.9676203727722168, 0.9712152481079102, 0.9800809025764465, 0.971030592918396, 0.9461634755134583, 0.9137604832649231, 0.8885034918785095, 0.9285866022109985, 0.9542095065116882, 0.9563965797424316, 0.9683604836463928, 0.9707298874855042, 0.9679570198059082, 0.9543455839157104, 0.9446698427200317, 0.9494118094444275, 0.9457918405532837, 0.9084529280662537, 0.8782286643981934, 0.899350643157959, 0.9182429909706116, 0.9108826518058777, 0.8920799493789673, 0.9062361717224121, 0.9227715134620667, 0.9202852845191956, 0.9170984029769897, 0.9079746603965759, 0.9006496071815491, 0.8841670751571655, 0.8730648159980774, 0.8797760009765625, 0.879978358745575, 0.8729199767112732, 0.8632707595825195, 0.8472877144813538, 0.8204310536384583, 0.7796118259429932, 0.7037785649299622, 0.6006735563278198, 0.47956642508506775, 0.3674113154411316, 0.2906504273414612, 0.24475176632404327, 0.21850566565990448, 0.20367980003356934, 0.20240485668182373, 0.21325859427452087, 0.23959723114967346, 0.284677654504776, 0.3606809973716736, 0.4674353003501892, 0.5562193393707275, 0.6389272212982178, 0.7427515387535095, 0.8140857815742493, 0.8426780700683594, 0.8598964810371399, 0.8522467613220215, 0.8421714901924133, 0.8539685606956482, 0.8772027492523193, 0.8998239636421204, 0.9073407649993896, 0.9045922160148621, 0.8965725898742676, 0.8696987628936768, 0.8281118869781494, 0.8452182412147522, 0.9115826487541199, 0.9384804964065552, 0.947258472442627, 0.961547315120697, 0.9619706869125366, 0.9565796852111816, 0.9533475041389465, 0.9572670459747314, 0.9448310136795044, 0.9116548299789429, 0.9113317728042603, 0.9492184519767761, 0.9775646328926086, 0.9762332439422607, 0.9647400379180908, 0.9614595174789429, 0.9742123484611511, 0.9780237078666687, 0.9717063903808594, 0.9819183945655823, 0.9866434335708618, 0.9849352836608887, 0.979595959186554, 0.978759765625, 0.9722258448600769, 0.975616991519928, 0.9835595488548279, 0.9797523617744446, 0.9808520078659058, 0.991864800453186, 0.9912581443786621, 0.985670804977417, 0.9888935089111328, 0.99378901720047, 0.9981174468994141, 0.993330180644989, 0.992511510848999, 0.9944184422492981, 1.000044584274292, 1.0017060041427612, 1.0051958560943604, 1.0048195123672485, 0.9877723455429077, 0.9981621503829956, 1.0040196180343628, 0.9926708936691284, 0.9945114850997925, 0.997383177280426, 0.9925097823143005, 0.9908336997032166, 0.9911311268806458, 0.9798170924186707, 0.9652153253555298, 0.9205644130706787, 0.7669870257377625, 0.5999383926391602, 0.680784285068512, 0.8818573951721191, 0.9622437953948975, 0.9791319370269775, 0.9789847731590271, 0.9799993634223938, 0.9813719987869263, 0.9745046496391296, 0.9740679860115051, 0.9817249774932861, 0.9942259788513184, 0.9973159432411194, 0.9950113892555237, 0.9930394887924194, 0.9870155453681946, 0.9951810240745544, 1.0039290189743042, 0.993482768535614, 0.98197340965271, 0.9837135076522827, 0.9863971471786499, 0.969758152961731, 0.9543136358261108, 0.9614388942718506, 0.9769801497459412, 0.9948585033416748, 1.000147819519043, 0.9987376928329468, 1.002994179725647, 1.0039541721343994, 1.0026787519454956, 1.001217246055603, 1.0012770891189575, 1.0062795877456665, 1.0058125257492065, 0.9929420351982117, 0.9888095855712891, 0.9830800294876099, 0.937609851360321, 0.8809226155281067, 0.9026933908462524, 0.9194258451461792, 0.7390916347503662, 0.5848644375801086, 0.725700318813324, 0.9215967059135437, 0.9968541264533997, 1.010123372077942, 1.0114315748214722, 1.0075448751449585, 1.0097309350967407, 1.0047922134399414, 1.0039864778518677, 1.0068074464797974, 1.003919243812561, 1.0001927614212036, 0.9964123964309692, 0.9965001344680786, 0.999755322933197, 0.9474176168441772, 0.7763375043869019, 0.7346488237380981, 0.8947324752807617, 0.9939713478088379, 1.0062534809112549, 1.0052913427352905, 0.9996984004974365, 0.9942729473114014, 0.9806586503982544, 0.8609815835952759, 0.6414839029312134, 0.6531829237937927, 0.7646950483322144, 0.7710044980049133, 0.8489572405815125, 0.9506644010543823, 0.9935805201530457, 1.0067567825317383, 1.008969783782959, 1.0059994459152222, 0.9996660947799683, 0.9932059049606323, 0.9964351654052734, 1.0019422769546509, 0.9964473843574524, 0.9857768416404724, 0.9832279086112976, 0.9911230206489563, 0.9849376678466797, 0.9896368980407715, 0.9887381792068481, 0.9903467893600464, 0.9971280097961426, 0.9910218715667725, 0.9914840459823608, 0.9928000569343567, 0.9994180202484131, 1.0064061880111694, 1.0084847211837769, 1.0113524198532104, 0.9984202980995178, 0.9969068765640259, 0.9995102286338806, 1.0035240650177002, 0.9999858736991882, 1.0003201961517334, 1.0017645359039307, 1.0036450624465942, 1.0054830312728882, 1.0079705715179443, 1.0001112222671509, 0.9974258542060852, 1.0000399351119995, 0.9972583055496216, 0.9985119700431824, 1.0023952722549438, 1.004414439201355, 1.0027376413345337, 1.0025924444198608, 0.993145227432251, 0.9918097853660583, 0.9993085861206055, 1.0007153749465942, 1.000065565109253, 0.9935339093208313, 0.9830158948898315, 0.9843484163284302, 0.9985418319702148, 1.0002305507659912, 0.9931469559669495, 0.995244562625885, 0.9974891543388367, 0.9939900040626526, 0.9731389284133911, 0.9543589949607849, 0.9641766548156738, 0.972909688949585, 0.9892798662185669, 1.0030349493026733, 1.001649260520935, 1.000209927558899, 0.988764762878418, 0.9799548387527466, 0.9620513319969177, 0.9624292254447937, 0.8890756964683533, 0.7662181854248047, 0.8282124996185303, 0.9530089497566223, 0.98683100938797, 0.9926595687866211, 0.9951906800270081, 0.9883792996406555, 0.9926645755767822, 0.993170440196991, 0.9917827248573303, 0.9990350008010864, 0.9890850782394409, 0.9761767387390137, 0.9844033718109131, 0.9922304749488831, 0.9961584210395813, 0.9976820349693298, 0.9912241101264954, 0.9873777031898499, 0.9742152690887451, 0.97740638256073, 0.9803619980812073, 0.9887789487838745, 0.9858464598655701, 0.9799850583076477, 0.9965820908546448, 0.9961483478546143, 0.998546302318573, 0.9968445897102356, 0.9819457530975342, 0.9464539289474487, 0.9323782920837402, 0.9653517007827759, 0.9739295244216919, 0.9697585701942444, 0.9855917692184448, 0.9967105984687805, 0.9937686324119568, 0.9927230477333069, 1.00142502784729, 0.9978989362716675, 0.986812174320221, 0.9766268134117126, 0.9962456822395325, 1.0060921907424927, 1.001078486442566, 1.0119779109954834, 1.0088868141174316, 1.001983642578125, 1.0017626285552979, 0.9896393418312073, 0.9894726276397705, 0.9982166886329651, 0.9851164221763611, 0.9801803231239319, 0.9858785271644592, 0.9903193712234497, 0.9937134981155396, 1.0003243684768677, 0.9945729374885559, 0.9871561527252197, 0.9422542452812195, 0.803443193435669, 0.7325936555862427, 0.868351936340332, 0.9862313270568848, 0.9983290433883667, 0.9899601936340332, 0.986572802066803, 0.9680225253105164, 0.9371605515480042, 0.9399926066398621, 0.9542471766471863, 0.9703346490859985, 0.9892449975013733, 0.9905638098716736, 0.9846934080123901, 0.9910706281661987, 0.9958021640777588, 0.9973151087760925, 0.9981762170791626, 0.9966088533401489, 0.9964040517807007, 0.9909137487411499, 0.9980799555778503, 1.0126959085464478, 1.0068103075027466, 0.9906860589981079, 1.001478672027588, 1.0076992511749268, 1.0044375658035278, 0.9947824478149414, 0.9944953322410583, 1.0065975189208984, 1.000347375869751, 0.9881068468093872, 0.9868221282958984, 0.9912903308868408, 0.9896568059921265, 0.9840574860572815, 0.9964778423309326, 1.003404974937439, 0.9995768666267395, 1.0065628290176392, 1.0046449899673462, 1.0016740560531616, 1.0046905279159546, 1.002503752708435, 0.9933090806007385, 0.9896793961524963, 0.9989745616912842, 1.0098817348480225, 1.0128169059753418, 1.0094242095947266, 1.0089768171310425, 1.0106111764907837, 1.0060077905654907, 1.0043830871582031, 1.0072414875030518, 1.0072722434997559, 1.0087881088256836, 0.9983236193656921, 1.0057837963104248, 0.9760681390762329, 0.9346873164176941, 0.9598857164382935, 0.9862216114997864, 0.9946123957633972, 0.9921031594276428, 0.9928062558174133, 0.9969831705093384, 0.9843791723251343, 0.9840438961982727, 0.9968364238739014, 0.9928908944129944, 0.9979047179222107, 0.996752917766571, 0.9751277565956116, 0.9217966794967651, 0.8894097805023193, 0.9135133624076843, 0.9161224961280823, 0.8009268641471863, 0.5642402768135071, 0.438812792301178, 0.6301073431968689, 0.8462772369384766, 0.9412389397621155, 0.9652367234230042, 0.9665553569793701, 0.9696363806724548, 0.9842082262039185, 0.9845958948135376, 0.9671540260314941, 0.8350106477737427, 0.5974705815315247, 0.5584349036216736, 0.7834161520004272, 0.949769139289856, 0.994796633720398, 0.9950252175331116, 0.9991788268089294, 0.9900889992713928, 0.9851616024971008, 0.9874790906906128, 0.9898120760917664, 0.979437530040741, 0.9773367047309875, 0.9867661595344543, 0.9900909066200256, 0.99974125623703, 0.9964919090270996, 0.9926045536994934, 0.9800752997398376, 0.9837167263031006, 0.997795820236206, 0.9951147437095642, 0.9999256134033203, 0.997813880443573, 0.9800569415092468, 0.9641876220703125, 0.9753462076187134, 0.9911001324653625, 0.9984989166259766, 1.00029456615448, 1.003025770187378, 1.0083225965499878, 1.0083674192428589, 1.0034894943237305, 0.9924436807632446, 0.9978262186050415, 1.0021183490753174, 1.0138201713562012, 0.9919216632843018, 0.9918051958084106, 0.9950537085533142, 0.996045708656311, 1.0051466226577759, 0.987882137298584, 0.9444836974143982, 0.8267523050308228, 0.7796018123626709, 0.8909658789634705, 0.9814814329147339, 1.0055208206176758, 1.0076980590820312, 1.012492299079895, 1.0034432411193848, 1.0056368112564087, 1.0055274963378906, 0.995137631893158, 1.002474308013916, 0.9654361605644226, 0.9046275019645691, 0.8993321061134338, 0.9571477174758911, 1.0017237663269043, 1.0097088813781738, 0.9742966890335083, 0.8539344668388367, 0.7775871157646179, 0.898716390132904, 0.9885428547859192, 0.9972537159919739]
ytest = []
for i in range(nptsPrimSt):
    ytest.append(yin[i]-yout[i])

#print ytest
f = plt.figure(figsize=(10, 5), dpi=150)
#plt.style.use('seaborn-v0_8-whitegrid')  # Cambiar si tienes preferencias
plt.plot(workingLambdaValues, yin,  label=f'v = {0.0} km/s', lw = 1.5 )


for i in range(8):
    PRMRot = 2.5 +i*10
    print ("Rotation parameter: ", PRMRot)
    yout = starot (nptsPrimSt, yin, PRMRot,midLambda, deltaStep)#, ytest) 
    #cnst = (midLambda/299792.458)/deltaStep     #Conversion Factor from Doppler Effect Formula
    #pdch = -PRMRot * cnst
    #youtshifted = fshift(nptsPrimSt,yout,pdch)
    # plt.plot(workingLambdaValues, yout,  lw = 0.5)
    plt.plot(workingLambdaValues, yout, lw=1.5, label=f'v = {PRMRot} km/s')
print ("///////////////////////////////////////////////////////")
# for i in range(8):
#     PRMRot = 2.5 +i*10
#     print ("Rotation parameter: ", PRMRot)
#     yout = rotBroad(workingLambdaValues, yin, 0.6, PRMRot)
#     plt.plot(workingLambdaValues, yout, lw = 0.5)

#plt.plot(inputObject.workingLambdaValues, phi[0:len(inputObject.workingLambdaValues)])
plt.axvline(midLambda, color='gray', linestyle='--', lw=0.5)
# plt.title("Synthetic Spectral Line Profiles with Varying Rotational Velocities (v sin i)")
plt.xlabel(r"$\lambda\ [\mathrm{\AA}]$")
plt.ylabel("Normalised Flux")
# plt.legend()
plt.legend(fontsize='small', loc='lower right')
plt.xlim(6559, 6566)
plt.ylim(0.1, 1.15)
plt.savefig("rotational_broadening.png", dpi=300, bbox_inches='tight')
plt.show()

